//Free to use and distribute
//Vigenère cipher - Encryption

// Plaintext: HELPMEDEARBRYANHELPMEBROTHERIAMREACHINGOUTMYWIFELEFTMEIAMALLALONEBRIANDOVISITMEIAMALLSADANDALONEIFEELLIKECRYING
// PLAINTEXT: THEEUROPEANLANGUAGESAREMEMBERSOFTHESAMEFAMILYTHEIRSEPARATEEXISTENCEISAMYTHFORSCIENCEMUSICSPORTETCEUROPEUSESTHESAMEVOCABULARYTHELANGUAGESONLYDIFFERINTHEIRGRAMMARTHEIRPRONUNCIATIONANDTHEIRMOSTCOMMONWORDSEVERYONEREALIZESWHYANEWCOMMONLANGUAGEWOULDBEDESIRABLEONECOULDREFUSETOPAYEXPENSIVETRANSLATORSTOACHIEVETHISITWOULDBENECESSARYTOHAVEUNIFORMGRAMMARPRONUNCIATIONANDMORECOMMONWORDSIFSEVERALLANGUAGESCOALESCETHEGRAMMAROFTHERESULTINGLANGUAGEISMORESIMPLEANDREGULARTHANTHATOFTHEINDIVIDUALLANGUAGESTHENEWCOMMONLANGUAGEWILLBEMORESIMPLEANDREGULARTHANTHEEXISTINGEUROPEANLANGUAGESITWILLBEASSIMPLEASOCCIDENTALINFACTITWILLBEOCCIDENTALTOANENGLISHPERSONITWILLSEEMLIKESIMPLIFIEDENGLISHASASKEPTICALCAMBRIDGEFRIENDOFMINETOLDMEWHATOCCIDENTALISTHEEUROPEANLANGUAGESAREMEMBERSOFTHESAMEFAMILYTHEIRSEPARATEEXISTENCEISAMYTHFORSCIENCEMUSICSPORTETCEUROPEUSESTHESAMEVOCABULARYTHELANGUAGESONLYDIFFERINTHEIRGRAMMARTHEIRPRONUNCIATIONANDTHEIRMOSTCOMMONWORDSEVERYONEREALIZESWHYANEWCOMMONLANGUAGEWOULDBEDESIRABLEONECOULDREFUSETOPAYEXPENSIVETRANSLATORSTOACHIEVETHISITWOULDBENECESSARYTOHAVEUNIFORMGRAMMARPRONUNCIATIONANDMORECOMMONWORDSIFSEVERALLANGUAGESCOALESCETHEGRAMMAROFTHERESULTINGLANGUAGEISMORESIMPLEANDREGULARTHANTHATOFTHEINDIVIDUALLANGUAGESTHENEWCOMMONLANGUAGEWILLBEMORESIMPLEANDREGULARTHANTHEEXISTINGEUROPEANLANGUAGESITWILLBEASSIMPLEASOCCIDENTALINFACTITWILLBEOCCIDENTALTOANENGLISHPERSONITWILLSEEMLIKESIMPLIFIEDENGLISHASASKEPTICALCAMBRIDGEFRIENDOFMINETOLDMEWHATOCCIDENTALISTHEEUROPEANLANGUAGESAREMEMBERSOFTHESAMEFAMILYTHEIRSEPARATEEXISTENCEISAMYTHFORSCIENCEMUSICSPORTETCEUROPEUSESTHESAMEVOCABULARYTHELANGUAGESONLYDIFFERINTHEIRGRAMMARTHEIRPRONUNCIATIONANDTHEIRMOSTCOMMONWORDSEVERYONEREALIZESWHYANEWCOMMONLANGUAGEWOULDBEDESIRABLEONECOULDREFUSETOPAYEXPENSIVETRANSLATORSTOACHIEVETHISITWOULDBENECESSARYTOHAVEUNIFORMGRAMMARPRONUNCIATIONANDMORECOMMONWORDSIFSEVERALLANGUAGESCOALESCETHEGRAMMAROFTHERESULTINGLANGUAGEISMORESIMPLEANDREGULARTHANTHATOFTHEINDIVIDUALLANGUAGESTHENEWCOMMONLANGUAGEWILLBEMORESIMPLEANDREGULARTHANTHEEXISTINGEUROPEANLANGUAGESITWILLBEASSIMPLEASOCCIDENTALINFACTITWILLBEOCCIDENTALTOANENGLISHPERSONITWILLSEEMLIKESIMPLIFIEDENGLISHASASKEPTICALCAMBRIDGEFRIENDOFMINETOLDMEWHATOCCIDENTALISTHEEUROPEANLANGUAGESAREMEMBERSOFTHESAMEFAMILYTHEIRSEPARATEEXISTENCEISAMYTHFORSCIENCEMUSICSPORTETCEUROPEUSESTHESAMEVOCABULARYTHELANGUAGESONLYDIFFERINTHEIRGRAMMARTHEIRPRONUNCIATIONANDTHEIRMOSTCOMMONWORDSEVERYONEREALIZESWHYANEWCOMMONLANGUAGEWOULDBEDESIRABLEONECOULDREFUSETOPAYEXPENSIVETRANSLATORSTOACHIEVETHISITWOULDBENECESSARYTOHAVEUNIFORMGRAMMARPRONUNCIATIONANDMORECOMMONWORDSIFSEVERALLANGUAGESCOALESCETHEGRAMMAROFTHERESULTINGLANGUAGEISMORESIMPLEANDREGULARTHANTHATOFTHEINDIVIDUALLANGUAGESTHENEWCOMMONLANGUAGEWILLBEMORESIMPLEANDREGULARTHANTHEEXISTINGEUROPEANLANGUAGESITWILLBEASSIMPLEASOCCIDENTALINFACTITWILLBEOCCIDENTALTOANENGLISHPERSONITWILLSEEMLIKESIMPLIFIEDENGLISHASASKEPTICALCAMBRIDGEFRIENDOFMINETOLDMEWHATOCCIDENTALISTHEEUROPEANLANGUAGESAREMEMBERSOFTHESAMEFAMILYTHEIRSEPARATEEXISTENCEISAMYTHFORSCIENCEMUSICSPORTETCEUROPEUSESTHESAMEVOCABULARYTHELANGUAGESONLYDIFFERINTHEIRGRAMMARTHEIRPRONUNCIATIONANDTHEIRMOSTCOMMONWORDSEVERYONEREALIZESWHYANEWCOMMONLANGUAGEWOULDBEDESIRABLEONECOULDREFUSETOPAYEXPENSIVETRANSLATORSTOACHIEVETHISITWOULDBENECESSARYTOHAVEUNIFORMGRAMMARPRONUNCIATIONANDMORECOMMON
// PLAINTEXT: THEFIRSTWELLDOCUMENTEDDESCRIPTIONOFAPOLYALPHABETICCIPHERWASBYLEONBATTISTAALBERTIANDUSEDAMETALCIPHERDISKTOSWITCHBETWEENCIPHERALPHABETSALBERTISSYSTEMONLYSWITCHEDALPHABETSAFTERSEVERALWORDSANDSWITCHESWEREINDICATEDBYWRITINGTHELETTEROFTHECORRESPONDINGALPHABETINTHECIPHERTEXTLATERJOHANNESTRITHEMIUSINHISWORKPOLYGRAPHIAEWHICHWASCOMPLETEDINMANUSCRIPTFORMBUTFIRSTPUBLISHEDLATERINVENTEDTHETABULARECTAACRITICALCOMPONENTOFTHEVIGENERECIPHERTHETRITHEMIUSCIPHERHOWEVERPROVIDEDAPROGRESSIVERATHERRIGIDANDPREDICTABLESYSTEMFORSWITCHINGBETWEENCIPHERALPHABETSTHECIPHERNOWKNOWNASTHEVIGENERECIPHERHOWEVERISTHATORIGINALLYDESCRIBEDBYGIOVANBATTISTABELLASOINHISBOOKLACIFRADELSIGGIOVANBATTISTABELLASOHEBUILTUPONTHETABULARECTAOFTRITHEMIUSBUTADDEDAREPEATINGCOUNTERSIGNAKEYTOSWITCHCIPHERALPHABETSEVERYLETTERWHEREASALBERTIANDTRITHEMIUSUSEDAFIXEDPATTERNOFSUBSTITUTIONSBELLASOSSCHEMEMEANTTHEPATTERNOFSUBSTITUTIONSCOULDBEEASILYCHANGEDSIMPLYBYSELECTINGANEWKEYKEYSWERETYPICALLYSINGLEWORDSORSHORTPHRASESKNOWNTOBOTHPARTIESINADVANCEORTRANSMITTEDOUTOFBANDALONGWITHTHEMESSAGEBELLASOSMETHODTHUSREQUIREDSTRONGSECURITYFORONLYTHEKEYASITISRELATIVELYEASYTOSECUREASHORTKEYPHRASESUCHASBYAPREVIOUSPRIVATECONVERSATIONBELLASOSSYSTEMWASCONSIDERABLYMORESECUREINTHENINETEENTHCENTURYTHEINVENTIONOFBELLASOSCIPHERWASMISATTRIBUTEDTOVIGENEREDAVIDKAHNINHISBOOKTHECODEBREAKERSLAMENTEDTHISMISATTRIBUTIONSAYINGTHATHISTORYHADIGNOREDTHISIMPORTANTCONTRIBUTIONANDINSTEADNAMEDAREGRESSIVEANDELEMENTARYCIPHERFORHIMVIGENERETHOUGHHEHADNOTHINGTODOWITHITTHEVIGENERECIPHERGAINEDAREPUTATIONFORBEINGEXCEPTIONALLYSTRONGNOTEDAUTHORANDMATHEMATICIANCHARLESLUTWIDGEDODGSONLEWISCARROLLCALLEDTHEVIGENERECIPHERUNBREAKABLEINHISPIECETHEALPHABETCIPHERINACHILDRENSMAGAZINEINSCIENTIFICAMERICANDESCRIBEDTHEVIGENERECIPHERASIMPOSSIBLEOFTRANSLATIONTHATREPUTATIONWASNOTDESERVEDCHARLESBABBAGEISKNOWNTOHAVEBROKENAVARIANTOFTHECIPHERASEARLYBUTDIDNOTPUBLISHHISWORKKASISKIENTIRELYBROKETHECIPHERANDPUBLISHEDTHETECHNIQUEINTHENINETEENTHCENTURYBUTEVENINTHESIXTEENTHCENTURYSOMESKILLEDCRYPTANALYSTSCOULDOCCASIONALLYBREAKTHECIPHERTHEVIGENERECIPHERISSIMPLEENOUGHTOBEAFIELDCIPHERIFITISUSEDINCONJUNCTIONWITHCIPHERDISKSTHECONFEDERATESTATESOFAMERICAFOREXAMPLEUSEDABRASSCIPHERDISKTOIMPLEMENTTHEVIGENERECIPHERDURINGTHEAMERICANCIVILWARTHECONFEDERACYSMESSAGESWEREFARFROMSECRETANDTHEUNIONREGULARLYCRACKEDITSMESSAGESTHROUGHOUTTHEWARTHECONFEDERATELEADERSHIPPRIMARILYRELIEDUPONTHREEKEYPHRASESMANCHESTERBLUFFCOMPLETEVICTORYANDASTHEWARCAMETOACLOSECOMERETRIBUTIONTHEFIRSTWELLDOCUMENTEDDESCRIPTIONOFAPOLYALPHABETICCIPHERWASBYLEONBATTISTAALBERTIANDUSEDAMETALCIPHERDISKTOSWITCHBETWEENCIPHERALPHABETSALBERTISSYSTEMONLYSWITCHEDALPHABETSAFTERSEVERALWORDSANDSWITCHESWEREINDICATEDBYWRITINGTHELETTEROFTHECORRESPONDINGALPHABETINTHECIPHERTEXTLATERJOHANNESTRITHEMIUSINHISWORKPOLYGRAPHIAEWHICHWASCOMPLETEDINMANUSCRIPTFORMBUTFIRSTPUBLISHEDLATERINVENTEDTHETABULARECTAACRITICALCOMPONENTOFTHEVIGENERECIPHERTHETRITHEMIUSCIPHERHOWEVERPROVIDEDAPROGRESSIVERATHERRIGIDANDPREDICTABLESYSTEMFORSWITCHINGBETWEENCIPHERALPHABETSTHECIPHERNOWKNOWNASTHEVIGENERECIPHERHOWEVERISTHATORIGINALLYDESCRIBEDBYGIOVANBATTISTABELLASOINHISBOOKLACIFRADELSIGGIOVANBATTISTABELLASOHEBUILTUPONTHETABULARECTAOFTRITHEMIUSBUTADDEDAREPEATINGCOUNTERSIGNAKEYTOSWITCHCIPHERALPHABETSEVERYLETTERWHEREASALBERTIANDTRITHEMIUSUSEDAFIXEDPA
// PLAINTEXT: FRIEDRICHKASISKIWASTHEFIRSTTOPUBLISHASUCCESSFULGENERALATTACKONTHEVIGNERECIPHEREARLIERATTACKSRELIEDONKNOWLEDGEOFTHEPLAINTEXTORTHEUSEOFARECOGNIZABLEWORDASAKEYKASISKISMETHODHADNOSUCHDEPENDENCIESALTHOUGHKASISKIWASTHEFIRSTTOPUBLISHANACCOUNTOFTHEATTACKITISCLEARTHATOTHERSHADBEENAWAREOFITINCHARLESBABBAGEWASGOADEDINTOBREAKINGTHEVIGNERECIPHERWHENJOHNHALLBROCKTHWAITESSUBMITTEDANEWCIPHERTOTHEJOURNALOFTHESOCIETYOFTHEARTSWHENBABBAGESHOWEDTHATTHWAITESCIPHERWASESSENTIALLYJUSTANOTHERRECREATIONOFTHEVIGNERECIPHERTHWAITESPRESENTEDACHALLENGETOBABBAGEGIVENANORIGINALTEXTFROMSHAKESPEARESTHETEMPESTANDITSENCIPHEREDVERSIONHEWASTOFINDTHEKEYWORDSTHATTHWAITESHADUSEDTOENCIPHERTHEORIGINALTEXTBABBAGESOONFOUNDTHEKEYWORDSTWOANDCOMBINEDBABBAGETHENENCIPHEREDTHESAMEPASSAGEFROMSHAKESPEAREUSINGDIFFERENTKEYWORDSANDCHALLENGEDTHWAITESTOFINDBABBAGESKEYWORDSBABBAGENEVEREXPLAINEDTHEMETHODTHATHEUSEDSTUDIESOFBABBAGESNOTESREVEALTHATHEHADUSEDTHEMETHODLATERPUBLISHEDBYKASISKIANDSUGGESTTHATHEHADBEENUSINGTHEMETHODTHATISHOWEVERONLYANAPPROXIMATIONITSACCURACYINCREASESWITHTHESIZEOFTHETEXTITWOULDINPRACTICEBENECESSARYTOTRYVARIOUSKEYLENGTHSTHATARECLOSETOTHEESTIMATEABETTERAPPROACHFORREPEATINGKEYCIPHERSISTOCOPYTHECIPHERTEXTINTOROWSOFAMATRIXWITHASMANYCOLUMNSASANASSUMEDKEYLENGTHANDTHENTOCOMPUTETHEAVERAGEINDEXOFCOINCIDENCEWITHEACHCOLUMNCONSIDEREDSEPARATELYWHENTHATISDONEFOREACHPOSSIBLEKEYLENGTHTHEHIGHESTAVERAGEICTHENCORRESPONDSTOTHEMOSTLIKELYKEYLENGTHSUCHTESTSMAYBESUPPLEMENTEDBYINFORMATIONFROMTHEKASISKIEXAMINATIONONCETHELENGTHOFTHEKEYISKNOWNTHECIPHERTEXTCANBEREWRITTENINTOTHATMANYCOLUMNSWITHEACHCOLUMNCORRESPONDINGTOASINGLELETTEROFTHEKEYEACHCOLUMNCONSISTSOFPLAINTEXTTHATHASBEENENCRYPTEDBYASINGLECAESARCIPHERTHECAESARKEYSHIFTISJUSTTHELETTEROFTHEVIGNEREKEYTHATWASUSEDFORTHATCOLUMNUSINGMETHODSSIMILARTOTHOSEUSEDTOBREAKTHECAESARCIPHERTHELETTERSINTHECIPHERTEXTCANBEDISCOVEREDANIMPROVEMENTTOTHEKASISKIEXAMINATIONKNOWNASKERCKHOFFSMETHODMATCHESEACHCOLUMNSLETTERFREQUENCIESTOSHIFTEDPLAINTEXTFREQUENCIESTODISCOVERTHEKEYLETTERCAESARSHIFTFORTHATCOLUMNONCEEVERYLETTERINTHEKEYISKNOWNALLTHECRYPTANALYSTHASTODOISTODECRYPTTHECIPHERTEXTANDREVEALTHEPLAINTEXTKERCKHOFFSMETHODISNOTAPPLICABLEIFTHEVIGNERETABLEHASBEENSCRAMBLEDRATHERTHANUSINGNORMALALPHABETICSEQUENCESBUTKASISKIEXAMINATIONANDCOINCIDENCETESTSCANSTILLBEUSEDTODETERMINEKEYLENGTHTHEVIGENÈRECIPHERWITHNORMALALPHABETSESSENTIALLYUSESMODULOARITHMETICWHICHISCOMMUTATIVETHEREFOREIFTHEKEYLENGTHISKNOWNORGUESSEDSUBTRACTINGTHECIPHERTEXTFROMITSELFOFFSETBYTHEKEYLENGTHWILLPRODUCETHEPLAINTEXTENCRYPTEDWITHITSELFIFANYPROBABLEWORDINTHEPLAINTEXTISKNOWNORCANBEGUESSEDITSSELFENCRYPTIONCANBERECOGNIZEDWHICHALLOWSRECOVERYOFTHEKEYBYSUBTRACTINGTHEKNOWNPLAINTEXTFROMTHECIPHERTEXTKEYELIMINATIONISESPECIALLYUSEFULAGAINSTSHORTMESSAGESFRIEDRICHKASISKIWASTHEFIRSTTOPUBLISHASUCCESSFULGENERALATTACKONTHEVIGNERECIPHEREARLIERATTACKSRELIEDONKNOWLEDGEOFTHEPLAINTEXTORTHEUSEOFARECOGNIZABLEWORDASAKEYKASISKISMETHODHADNOSUCHDEPENDENCIESALTHOUGHKASISKIWASTHEFIRSTTOPUBLISHANACCOUNTOFTHEATTACKITISCLEARTHATOTHERSHADBEENAWAREOFITINCHARLESBABBAGEWASGOADEDINTOBREAKINGTHEVIGNERECIPHERWHENJOHNHALLBROCKTHWAITESSUBMITTEDANEWCIPHERTOTHEJOURNALOFTHESOCIETYOFTHEARTSWHENBABBAGESHOWEDTHATTHWAITESCIPHERWASESSENTIALLYJUSTANOTHERRECREATIONOFTHEVIGNERECIPHERTHWAITESPRESENTEDACHALLENGETOBABBAGEGIVENANOR

//HELPMEDEARBRYANHELPMEBROTHERIAMREACHINGOUTMYWIFELEFTMEIAMALLALONEBRIANDOVISITMEIAMALLSADANDALONEIFEELLIKECRYINGHELPMEDEARBRYANHELPMEBROT
//500character

#include <iostream>

#include "quadgram_analysis.h"
#include "vigenere.h"

int main()
{
	VigenereText input;
    std::cout << "-------------------------Vigenere cipher-------------------------\n";
    std::cout << "Please enter your plaintext: ";
    input.read_decrypted();
    //Input the Key and Encrypt
    std::cout << "Please enter the key: ";
    input.encrypt();
    //Display Ciphertext Results
	std::cout << "-----------------------------------\nCiphertext: " << input.encrypted << '\n';
	
    return 0;
}
